{"version":3,"sources":["config/Routes.ts","embed.ts"],"names":[],"mappings":";AAMO,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,SAAA,QAAA,SAAA,QAAA,eAAA,QAAA,YAAA,QAAA,aAAA,QAAA,UAAA,QAAA,eAAA,EANA,IAAM,EAAY,qBAMlB,QAAA,UAAA,EALA,IAAM,EAAY,gBAKlB,QAAA,UAAA,EAJA,IAAM,EAAW,SAAC,GAAiB,OAAA,EAAU,QAAQ,QAAS,IAI9D,QAAA,SAAA,EAHA,IAAM,EAAW,SAAC,GAAiB,OAAA,EAAU,QAAQ,QAAS,IAG9D,QAAA,SAAA,EAFA,IAAM,EAAe,SAAC,GAAiB,MAAA,SAAA,OAAS,IAEhD,QAAA,aAAA,EADA,IAAM,EAAc,SAAC,GAAkB,MAAA,GAAA,OAAwB,wBAAA,OAAG,EAAO,KAAA,OAAK,EAAa,IAAU,KACrG,QAAA,YAAA,EAAA,IAAM,EAAiB,SAAC,GAAsB,YAAtB,IAAA,IAAA,EAAA,IAAsB,GAAA,OAAuB,6BAAA,OAAG,IAAxE,QAAA,eAAA;;ACGN,aATD,IAAA,EAAA,QAAA,oBASC,SAAW,GACR,EAAO,UAAY,EAAO,WAAa,GACF,mBAA1B,EAAO,UAAU,OAG5B,EAAO,UAAU,KAAO,WACH,SAAS,iBACtB,+CAGK,QAAQ,SAAC,GACd,EAAQ,aAAa,sBAAuB,KACtC,IAAA,EAAgC,EAAQ,QAAtC,EAAQ,EAAA,SAAE,EAAM,EAAA,OAAE,EAAO,EAAA,QACjC,GAAK,EAAL,CAGA,IAAI,EACJ,OAAQ,GACJ,IAAK,OACD,EAAM,IAAU,EAAA,EAAA,cAAY,EAAA,EAAA,UAAS,IACrC,MACJ,IAAK,QACD,EAAM,IAAW,EAAA,EAAA,cAAY,EAAA,EAAA,UAAS,IAG9C,GAAK,EAAL,CAIA,IAAM,EAAO,EAAQ,aAAa,QAClC,GAAK,MAAA,OAAI,EAAJ,EAAM,YAAW,EAAA,EAAA,mBAAtB,CAKA,IAAI,EAAS,SAAS,cAAc,UACpC,EAAO,IAAM,EACb,EAAO,MAAM,OAAS,OACtB,EAAO,MAAM,UAAY,SACzB,EAAO,MAAM,UAAY,SACzB,EAAO,MAAM,QAAU,QACvB,EAAO,OAAS,WAzC3B,IAAA,EA0CmC,QAApB,EAAA,EAAO,qBAAa,IAAA,GAAA,EAAE,iBAClB,UACA,SAAC,GAEG,GADA,QAAQ,IAAI,IACR,EAAA,EAAA,eAAc,WAAW,EAAM,QAAS,CAClC,IAAA,EAAoB,EAAM,KAAxB,EAAK,EAAA,MAAE,EAAM,EAAA,OACjB,IACA,EAAO,MAAM,OAAS,EAAS,MAE/B,IACA,EAAO,MAAM,MAAQ,EAAQ,SAIzC,IAIR,EAAQ,MAAM,GACd,EAAQ,MAAM,QAAU,YA9BpB,QAAQ,IAAI,6BAA8B,MAAA,OAAI,EAAJ,EAAM,YAAW,EAAA,EAAA,0BA/B1E,CAgEE","file":"embed.js","sourceRoot":"../src","sourcesContent":["export const TRIP_PAGE = '/experiences/:slug'\nexport const HOST_PAGE = '/guides/:slug'\nexport const tripLink = (slug: string) => TRIP_PAGE.replace(':slug', slug)\nexport const hostLink = (slug: string) => HOST_PAGE.replace(':slug', slug)\nexport const getEmbedPath = (path: string) => `/embed${path}`\nexport const getEmbedUrl = (path?: string) => `${process.env.EMBED_URL}${path ? `/#${getEmbedPath(path)}` : ''}`\nexport const getExternalUrl = (path: string = '') => `${process.env.SITE_URL}${path}`\n","import { getEmbedUrl, getExternalUrl, hostLink, tripLink } from './config/Routes'\ndeclare global {\n    interface Window {\n        OGWidgets: {\n            init: () => void\n        }\n    }\n}\n\n;(function (window) {\n    window.OGWidgets = window.OGWidgets || {}\n    if (typeof window.OGWidgets.init === 'function') {\n        return\n    }\n    window.OGWidgets.init = () => {\n        const elements = document.querySelectorAll(\n            '[data-og-widget]:not([data-og-initialized])'\n        ) as NodeListOf<HTMLElement>\n\n        elements.forEach((element) => {\n            element.setAttribute('data-og-initialized', '1')\n            const { ogWidget, ogTrip, ogGuide } = element.dataset\n            if (!ogWidget) {\n                return\n            }\n            let url\n            switch (ogWidget) {\n                case 'trip':\n                    url = ogTrip && getEmbedUrl(tripLink(ogTrip))\n                    break\n                case 'guide':\n                    url = ogGuide && getEmbedUrl(hostLink(ogGuide))\n                    break\n            }\n            if (!url) {\n                return\n            }\n\n            const href = element.getAttribute('href')\n            if (!href?.startsWith(getExternalUrl())) {\n                console.log('external link dont match: ', href?.startsWith(getExternalUrl()))\n                return\n            }\n\n            var iframe = document.createElement('iframe')\n            iframe.src = url\n            iframe.style.border = 'none'\n            iframe.style.overflowX = 'hidden'\n            iframe.style.overflowY = 'hidden'\n            iframe.style.display = 'block'\n            iframe.onload = () => {\n                iframe.contentWindow?.addEventListener(\n                    'message',\n                    (event) => {\n                        console.log(event)\n                        if (getEmbedUrl().startsWith(event.origin)) {\n                            const { width, height } = event.data\n                            if (height) {\n                                iframe.style.height = height + 'px'\n                            }\n                            if (width) {\n                                iframe.style.width = width + 'px'\n                            }\n                        }\n                    },\n                    false\n                )\n            }\n\n            element.after(iframe)\n            element.style.display = 'none'\n        })\n    }\n})(window)\n"]}